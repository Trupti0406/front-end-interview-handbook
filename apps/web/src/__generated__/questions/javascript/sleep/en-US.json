{
  "description": "var Component=(()=>{var h=Object.create;var s=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var f=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),x=(o,e)=>{for(var t in e)s(o,t,{get:e[t],enumerable:!0})},c=(o,e,t,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let l of g(e))!m.call(o,l)&&l!==t&&s(o,l,{get:()=>e[l],enumerable:!(a=u(e,l))||a.enumerable});return o};var y=(o,e,t)=>(t=o!=null?h(p(o)):{},c(e||!o||!o.__esModule?s(t,\"default\",{value:o,enumerable:!0}):t,o)),b=o=>c(s({},\"__esModule\",{value:!0}),o);var r=f((_,i)=>{i.exports=_jsx_runtime});var k={};x(k,{default:()=>v,frontmatter:()=>j});var n=y(r()),j={title:\"Sleep\",excerpt:\"Implement a function that pauses for a specified duration before resuming execution\"};function d(o){let e=Object.assign({p:\"p\",code:\"code\",pre:\"pre\",strong:\"strong\",h2:\"h2\"},o.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"In JavaScript, the \",(0,n.jsx)(e.code,{children:\"setTimeout\"}),\" function can be used to execute callbacks after a delay. However, it introduces a layer of nesting in the code which may not be desired. It'd be nice to use \",(0,n.jsx)(e.code,{children:\"setTimeout\"}),\" in this fashion:\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`// Note: the following code contains invalid syntax and doesn't work.\nconsole.log('Hello!');\nsetTimeout(1000);\nconsole.log('Bye.');\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[\"In languages like Java and Python, a \",(0,n.jsx)(e.code,{children:\"sleep\"}),\" function is available to suspend execution of the calling thread. However, unlike other languages, JavaScript is single-threaded and blocking the main thread is not a good idea. Hence lets implement an \",(0,n.jsx)(e.strong,{children:\"asynchronous\"}),\" version of the \",(0,n.jsx)(e.code,{children:\"sleep\"}),\" function that works similarly but does not block the main thread.\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"Example\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`async function greeting() {\n  console.log('Hello!');\n  await sleep(2000);\n  console.log('Bye.'); // Only logs after 2000 milliseconds (2 seconds)\n}\n\ngreeting();\n// t = 0: Hello!\n// t = 2000: Bye.\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[\"The \",(0,n.jsx)(e.code,{children:\"sleep\"}),\" function should also be able to be used without \",(0,n.jsx)(e.code,{children:\"await\"}),\":\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`console.log('Hello!');\nsleep(2000).then(() => {\n  console.log('Bye.'); // Only logs after 2000 milliseconds (2 seconds)\n});\n`})})]})}function w(o={}){let{wrapper:e}=o.components||{};return e?(0,n.jsx)(e,Object.assign({},o,{children:(0,n.jsx)(d,o)})):d(o)}var v=w;return b(k);})();\n;return Component;",
  "format": "javascript",
  "metadata": {
    "author": null,
    "companies": [],
    "created": 1683331200,
    "difficulty": "easy",
    "duration": 5,
    "excerpt": "Implement a function that pauses for a specified duration before resuming execution",
    "featured": false,
    "format": "javascript",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/javascript/sleep",
    "importance": "low",
    "languages": [
      "js",
      "ts"
    ],
    "nextQuestions": [],
    "premium": true,
    "published": true,
    "ranking": 100,
    "similarQuestions": [],
    "slug": "sleep",
    "subtitle": null,
    "title": "Sleep",
    "topics": []
  },
  "skeleton": {
    "js": "/**\n * @param {number} duration\n * @return {Promise<any>}\n */\nexport default async function sleep(duration) {\n  throw 'Not implemented';\n}",
    "ts": "export default async function sleep(duration: number): Promise<any> {\n  throw 'Not implemented';\n}"
  },
  "solution": "var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var w=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),x=(i,e)=>{for(var t in e)c(i,t,{get:e[t],enumerable:!0})},r=(i,e,t,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of f(e))!k.call(i,o)&&o!==t&&c(i,o,{get:()=>e[o],enumerable:!(l=g(e,o))||l.enumerable});return i};var y=(i,e,t)=>(t=i!=null?p(m(i)):{},r(e||!i||!i.__esModule?c(t,\"default\",{value:i,enumerable:!0}):t,i)),T=i=>r(c({},\"__esModule\",{value:!0}),i);var d=w((H,s)=>{s.exports=_jsx_runtime});var B={};x(B,{default:()=>b});var n=y(d());var h=MDXCodeBlock;var a=`/**\n * @param {number} duration\n * @return {Promise<any>}\n */\nexport default async function sleep(duration) {\n  return new Promise((resolve) => setTimeout(resolve, duration));\n}\n`;function u(i){let e=Object.assign({h2:\"h2\",ol:\"ol\",li:\"li\",code:\"code\",p:\"p\",pre:\"pre\",h3:\"h3\",ul:\"ul\",a:\"a\"},i.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{children:\"Solution\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"The sleep function takes a \",(0,n.jsx)(e.code,{children:\"duration\"}),\" parameter representing the time in milliseconds for which the execution should be paused.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"It returns a \",(0,n.jsx)(e.code,{children:\"Promise\"}),\" that will resolve after the specified \",(0,n.jsx)(e.code,{children:\"duration\"}),\".\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Inside the \",(0,n.jsx)(e.code,{children:\"Promise\"}),\" constructor, use \",(0,n.jsx)(e.code,{children:\"setTimeout\"}),\" to delay the execution of the \",(0,n.jsx)(e.code,{children:\"resolve\"}),\" function, effectively pausing the execution for the specified time.\"]}),`\n`]}),`\n`,(0,n.jsx)(h,{children:a}),`\n`,(0,n.jsxs)(e.h2,{children:[\"Blocking version of \",(0,n.jsx)(e.code,{children:\"sleep()\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"A synchronous, blocking function of \",(0,n.jsx)(e.code,{children:\"sleep\"}),\" can be implemented as such, where the CPU does nothing except repeatedly check if \",(0,n.jsx)(e.code,{children:\"duration\"}),\" has passed since the function started running. Hence, it will pause all execution on the main thread and is usually not desired.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`function sleep(duration) {\n  let now = new Date().getTime();\n  while (new Date().getTime() < now + duration) {\n    // Do nothing.\n  }\n  // Proceed when \\`duration\\` has passed since \\`now\\`.\n}\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Here's an example to illustrate the difference between the two versions of \",(0,n.jsx)(e.code,{children:\"sleep\"}),\":\"]}),`\n`,(0,n.jsxs)(e.h3,{children:[\"Asynchronous \",(0,n.jsx)(e.code,{children:\"sleep\"})]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`async function greeting() {\n  console.log('Hello!');\n  await sleep(2000);\n  console.log('Bye.');\n}\n\nsetInterval(() => {\n  console.log('Tick');\n}, 500);\n\ngreeting();\n// t = 0: Hello!\n// t = 500: Tick\n// t = 1000: Tick\n// t = 1500: Tick\n// t = 2000: Tick\n// t = 2000: Bye.\n// t = 2500: Tick\n// t = 3000: Tick\n// ...\n`})}),`\n`,(0,n.jsxs)(e.h3,{children:[\"Synchronous/blocking \",(0,n.jsx)(e.code,{children:\"sleep\"})]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\"language-js\",children:`async function greeting() {\n  console.log('Hello!');\n  sleep(2000);\n  console.log('Bye.');\n}\n\nsetInterval(() => {\n  console.log('Tick');\n}, 500);\n\ngreeting();\n// t = 0: Hello!\n// t = 2000: Bye.\n// t = 2000: Tick\n// t = 2500: Tick\n// t = 3000: Tick\n// ...\n`})}),`\n`,(0,n.jsxs)(e.p,{children:['Note that in this example, the first \"Tick\" is only printed because the ',(0,n.jsx)(e.code,{children:\"sleep()\"}),\" function was executing the entire time (checking the \",(0,n.jsx)(e.code,{children:\"while\"}),\" condition for the full duration).\"]}),`\n`,(0,n.jsx)(e.h2,{children:\"Resources\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://builtin.com/software-engineering-perspectives/javascript-sleep\",children:\"How to Make JavaScript Sleep or Wait\"})}),`\n`]})]})}function j(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,Object.assign({},i,{children:(0,n.jsx)(u,i)})):u(i)}var b=j;return T(B);})();\n;return Component;",
  "tests": "import sleep from './sleep';\n\ndescribe('sleep', () => {\n  test('returns a promise', () => {\n    const sleepPromise = sleep(1);\n    expect(sleepPromise.then).toBeTruthy();\n    expect(sleepPromise.catch).toBeTruthy();\n    expect(sleepPromise.finally).toBeTruthy();\n  });\n\n  describe('executes after delay', () => {\n    test('with await', async () => {\n      expect.assertions(4);\n      let i = 0;\n      expect(i).toBe(0);\n      let now = Date.now();\n      await sleep(50);\n      expect(i).toBe(0);\n      i++;\n      expect(i).toBe(1);\n      expect(Date.now() - now).toBeGreaterThan(25);\n    });\n\n    test('delay of 0', (done) => {\n      expect.assertions(3);\n      let i = 0;\n      expect(i).toBe(0);\n      sleep(0).then(() => {\n        i++;\n        expect(i).toBe(2);\n        done();\n      });\n      i++;\n      expect(i).toBe(1);\n    });\n\n    test('delay bigger than 0', (done) => {\n      expect.assertions(3);\n      let i = 0;\n      expect(i).toBe(0);\n      sleep(50).then(() => {\n        i++;\n        expect(i).toBe(2);\n        done();\n      });\n      i++;\n      expect(i).toBe(1);\n    });\n\n    test('does not block other async operations', (done) => {\n      expect.assertions(4);\n      let i = 0;\n      expect(i).toBe(0);\n      sleep(50).then(() => {\n        i++;\n        expect(i).toBe(3);\n        done();\n      });\n      setTimeout(() => {\n        i++;\n        expect(i).toBe(2);\n      }, 25);\n      i++;\n      expect(i).toBe(1);\n    });\n  });\n});"
}