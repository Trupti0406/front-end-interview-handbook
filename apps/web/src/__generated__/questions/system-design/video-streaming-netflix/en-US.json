{
  "description": "var Component=(()=>{var m=Object.create;var r=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var w=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),f=(t,e)=>{for(var n in e)r(t,n,{get:e[n],enumerable:!0})},l=(t,e,n,s)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of p(e))!g.call(t,o)&&o!==n&&r(t,o,{get:()=>e[o],enumerable:!(s=d(e,o))||s.enumerable});return t};var x=(t,e,n)=>(n=t!=null?m(u(t)):{},l(e||!t||!t.__esModule?r(n,\"default\",{value:t,enumerable:!0}):n,t)),v=t=>l(r({},\"__esModule\",{value:!0}),t);var c=w((N,a)=>{a.exports=_jsx_runtime});var _={};f(_,{default:()=>y,frontmatter:()=>b});var i=x(c()),b={title:\"Video Streaming (e.g. Netflix)\",excerpt:\"Design a video streaming application like Netflix and YouTube\"};function h(t){let e=Object.assign({p:\"p\",h2:\"h2\",img:\"img\",h3:\"h3\",ul:\"ul\",li:\"li\",a:\"a\"},t.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:\"Designing a video streaming application is a common but complex system design question, but there are limited resources that provide a comprehensive guide on how to design the front end for such platforms.\"}),`\n`,(0,i.jsx)(e.h2,{children:\"Question\"}),`\n`,(0,i.jsx)(e.p,{children:\"Design a video streaming application that allows users to browse through a library of video content and watch videos, similar to platforms like Netflix and YouTube.\"}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/img/questions/video-streaming-netflix/video-streaming-netflix-recommendations.png\",alt:\"Netflix recommendations page\"})}),`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:\"/img/questions/video-streaming-netflix/video-streaming-netflix-video-player.png\",alt:\"Netflix video player\"})}),`\n`,(0,i.jsx)(e.h3,{children:\"Real-life examples\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://www.netflix.com\",children:\"https://www.netflix.com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://www.youtube.com\",children:\"https://www.youtube.com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://www.primevideo.com\",children:\"https://www.primevideo.com\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://www.hulu.com\",children:\"https://www.hulu.com\"})}),`\n`]})]})}function j(t={}){let{wrapper:e}=t.components||{};return e?(0,i.jsx)(e,Object.assign({},t,{children:(0,i.jsx)(h,t)})):h(t)}var y=j;return v(_);})();\n;return Component;",
  "format": "system-design",
  "metadata": {
    "author": null,
    "companies": [],
    "created": 1630800000,
    "difficulty": "hard",
    "duration": 30,
    "excerpt": "Design a video streaming application like Netflix and YouTube",
    "featured": false,
    "format": "system-design",
    "frameworkDefault": null,
    "frameworks": [],
    "href": "/questions/system-design/video-streaming-netflix",
    "importance": "high",
    "languages": [],
    "nextQuestions": [],
    "premium": true,
    "published": true,
    "ranking": 7,
    "similarQuestions": [],
    "slug": "video-streaming-netflix",
    "subtitle": null,
    "title": "Video Streaming (e.g. Netflix)",
    "topics": []
  },
  "solution": "var Component=(()=>{var s=Object.create;var l=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var b=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),v=(n,e)=>{for(var t in e)l(n,t,{get:e[t],enumerable:!0})},d=(n,e,t,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let a of p(e))!m.call(n,a)&&a!==t&&l(n,a,{get:()=>e[a],enumerable:!(r=u(e,a))||r.enumerable});return n};var g=(n,e,t)=>(t=n!=null?s(f(n)):{},d(e||!n||!n.__esModule?l(t,\"default\",{value:n,enumerable:!0}):t,n)),y=n=>d(l({},\"__esModule\",{value:!0}),n);var h=b((I,o)=>{o.exports=_jsx_runtime});var A={};v(A,{default:()=>x,tableOfContents:()=>w});var i=g(h()),w=[{depth:2,value:\"Requirements exploration\",id:\"requirements-exploration\",children:[{depth:3,value:\"What are the core features to be supported?\",id:\"what-are-the-core-features-to-be-supported\"},{depth:3,value:\"What is the desired video playback quality and resolution?\",id:\"what-is-the-desired-video-playback-quality-and-resolution\"},{depth:3,value:\"What functionality should the video player include?\",id:\"what-functionality-should-the-video-player-include\"},{depth:3,value:\"What devices will the application be used on?\",id:\"what-devices-will-the-application-be-used-on\"},{depth:3,value:\"What are the non-functional requirements?\",id:\"what-are-the-non-functional-requirements\"}]},{depth:2,value:\"Architecture / high-level design\",id:\"architecture--high-level-design\"},{depth:2,value:\"Data model\",id:\"data-model\"},{depth:2,value:\"Interface definition (API)\",id:\"interface-definition-api\"},{depth:2,value:\"Glossary\",id:\"glossary\"},{depth:2,value:\"Optimizations and deep dive\",id:\"optimizations-and-deep-dive\",children:[{depth:3,value:\"Video-specific\",id:\"video-specific\",children:[{depth:4,value:\"Adaptive streaming\",id:\"adaptive-streaming\"},{depth:4,value:\"Subtitles\",id:\"subtitles\"},{depth:4,value:\"Video player\",id:\"video-player\"}]},{depth:3,value:\"Performance\",id:\"performance\",children:[{depth:4,value:\"Preload poster image\",id:\"preload-poster-image\"}]},{depth:3,value:\"User experience\",id:\"user-experience\"},{depth:3,value:\"Accessibility (a11y)\",id:\"accessibility-a11y\"},{depth:3,value:\"Internationalization (i18n)\",id:\"internationalization-i18n\"}]},{depth:2,value:\"TODO\",id:\"todo\"},{depth:2,value:\"References\",id:\"references\"}];function c(n){let e=Object.assign({h2:\"h2\",h3:\"h3\",ul:\"ul\",li:\"li\",p:\"p\",hr:\"hr\",code:\"code\",a:\"a\",h4:\"h4\",pre:\"pre\"},n.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:\"requirements-exploration\",children:\"Requirements exploration\"}),`\n`,(0,i.jsx)(e.h3,{id:\"what-are-the-core-features-to-be-supported\",children:\"What are the core features to be supported?\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Browsing of recommended videos on the home page.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Watching a preview of the video within a small player when hovering over thumbnails on the home page.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Playback of video content on a dedicated page.\"}),`\n`]}),`\n`,(0,i.jsx)(e.h3,{id:\"what-is-the-desired-video-playback-quality-and-resolution\",children:\"What is the desired video playback quality and resolution?\"}),`\n`,(0,i.jsx)(e.p,{children:\"Different resolutions and streaming quality options should be supported.\"}),`\n`,(0,i.jsx)(e.h3,{id:\"what-functionality-should-the-video-player-include\",children:\"What functionality should the video player include?\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Video progress: Play, pause, rewind, forward, jumping (seeking) to a specific timestamp of the video.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Audio: Changing language, adjusting volume.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Toggling subtitles and selecting subtitle languages.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Seeing a thumbnail preview of the timestamp when the cursor is over the track.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Setting playback speed.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Making full screen.\"}),`\n`]}),`\n`,(0,i.jsx)(e.h3,{id:\"what-devices-will-the-application-be-used-on\",children:\"What devices will the application be used on?\"}),`\n`,(0,i.jsx)(e.p,{children:\"Primarily desktop but it should also be usable on tablet and mobile.\"}),`\n`,(0,i.jsx)(e.h3,{id:\"what-are-the-non-functional-requirements\",children:\"What are the non-functional requirements?\"}),`\n`,(0,i.jsx)(e.p,{children:\"Prioritize a smooth video watching experience, users shouldn't have to wait too long before they can start watching the video:\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Users on slow internet connections should still be able to watch the videos even if a lower quality version is to be served.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Reduce stuttering and buffering.\"}),`\n`]}),`\n`,(0,i.jsx)(e.hr,{}),`\n`,(0,i.jsx)(e.h2,{id:\"architecture--high-level-design\",children:\"Architecture / high-level design\"}),`\n`,(0,i.jsx)(e.p,{children:\"TODO\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Redux for player\"}),`\n`]}),`\n`,(0,i.jsx)(e.hr,{}),`\n`,(0,i.jsx)(e.h2,{id:\"data-model\",children:\"Data model\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Video list\"}),`\n`,(0,i.jsx)(e.li,{children:\"Video metadata store\"}),`\n`,(0,i.jsxs)(e.li,{children:[\"Video\",`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Source\"}),`\n`,(0,i.jsx)(e.li,{children:\"Title\"}),`\n`,(0,i.jsx)(e.li,{children:\"Description\"}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.li,{children:\"Video player buffer\"}),`\n`,(0,i.jsxs)(e.li,{children:[\"Video player state\",`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Buffered frames\"}),`\n`,(0,i.jsx)(e.li,{children:\"Current timestamp\"}),`\n`,(0,i.jsx)(e.li,{children:\"Volume\"}),`\n`,(0,i.jsx)(e.li,{children:\"Audio language\"}),`\n`,(0,i.jsx)(e.li,{children:\"Subtitle language\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.hr,{}),`\n`,(0,i.jsx)(e.h2,{id:\"interface-definition-api\",children:\"Interface definition (API)\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Recommendations API\"}),`\n`,(0,i.jsxs)(e.li,{children:[\"Media streaming API\",`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Video stream API\"}),`\n`,(0,i.jsx)(e.li,{children:\"Audio stream API\"}),`\n`,(0,i.jsx)(e.li,{children:\"The content is made available at a variety of different bit rates.\"}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.li,{children:\"Video thumbnail API\"}),`\n`,(0,i.jsx)(e.li,{children:\"Subtitle API\"}),`\n`]}),`\n`,(0,i.jsx)(e.hr,{}),`\n`,(0,i.jsx)(e.h2,{id:\"glossary\",children:\"Glossary\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Bitrate\"}),`\n`,(0,i.jsx)(e.li,{children:\"Framerate\"}),`\n`,(0,i.jsx)(e.li,{children:\"Buffering\"}),`\n`,(0,i.jsx)(e.li,{children:\"Codec\"}),`\n`,(0,i.jsx)(e.li,{children:\"MIME type\"}),`\n`,(0,i.jsx)(e.li,{children:\"Resolution\"}),`\n`,(0,i.jsx)(e.li,{children:\"FPS\"}),`\n`,(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:\"Range\"}),\" header\"]}),`\n`,(0,i.jsx)(e.li,{children:\"Video formats: webm vs mp4\"}),`\n`,(0,i.jsx)(e.li,{children:\"Bandwidth\"}),`\n`,(0,i.jsxs)(e.li,{children:[\"Streaming\",`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"use HTTP range requests to break the content into small segments. Each segment contains a short interval of playback time of content that is potentially many hours in duration, such as a movie or the live broadcast of a sport event.\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.h2,{id:\"optimizations-and-deep-dive\",children:\"Optimizations and deep dive\"}),`\n`,(0,i.jsx)(e.h3,{id:\"video-specific\",children:\"Video-specific\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Custom video src and stream.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Separate out audio and video stream so that the video stream can be reused even if the audio changes.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:\"https://w3c.github.io/media-capabilities/\",children:\"Media capabilities API\"}),\" allows websites to get more information about the client's video decode performance and make an informed decision about which codec and resolution to deliver to the user.\"]}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[\"YouTube used the Media Capabilities API to prevent their adaptive bitrate algorithm from automatically selecting resolutions that a device could not play smoothly. Source: \",(0,i.jsx)(e.a,{href:\"https://web.dev/case-studies/youtube-media-capabilities\",children:\"https://web.dev/case-studies/youtube-media-capabilities\"})]}),`\n`]}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Don't transfer more than necessary, especially if the video is paused.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Only need to transfer audio if tab is in the background.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Don't autoplay unless tab is in focus.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Client uses a bit rate adaptation (ABR) algorithm to automatically select the segment with the highest bit rate possible that can be downloaded in time for playback without causing stalls or re-buffering events in the playback.\"}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.h4,{id:\"adaptive-streaming\",children:\"Adaptive streaming\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Adaptive streaming: real-time selection of audio/video bitrates based on available bandwidth and other factors.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Dynamic Adaptive Streaming over HTTP (DASH), also known as MPEG-DASH, is an adaptive bitrate streaming technique that enables high quality streaming of media content over the Internet delivered from conventional HTTP web servers. MPEG-DASH works by breaking the content into a sequence of small segments, which are served over HTTP.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Thus, an MPEG-DASH client can seamlessly adapt to changing network conditions and provide high quality playback with few stalls or re-buffering events.\"}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://reference.dashif.org/dash.js/\",children:\"dash.js\"})}),`\n`,(0,i.jsx)(e.li,{children:\"Thus, an MPEG-DASH client can seamlessly adapt to changing network conditions and provide high quality playback with few stalls or re-buffering events.\"}),`\n`]}),`\n`,(0,i.jsx)(e.h4,{id:\"subtitles\",children:\"Subtitles\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://netflixtechblog.com/implementing-japanese-subtitles-on-netflix-c165fbe61989\",children:\"https://netflixtechblog.com/implementing-japanese-subtitles-on-netflix-c165fbe61989\"})}),`\n`]}),`\n`,(0,i.jsx)(e.h4,{id:\"video-player\",children:\"Video player\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsxs)(e.p,{children:[\"Centralized top-level component, one UI update (paint) for any state change, eliminating chained updates. \",(0,i.jsx)(e.a,{href:\"https://web.dev/case-studies/better-youtube-web-part1\",children:\"source\"})]}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Netflix uses Redux + data normalization.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:'Separate video lifecycle from UI lifecycle. \"However, if the logic for managing the video playback exists outside of the UI component tree, it can be executed from anywhere inside of the application, such as before the UI tree is rendered during the initial application loading sequence. By kicking off the creation of a video in parallel with rendering the UI, it gives the application more time to create, initialize, and buffer video playback so that when the UI has finished rendering, the user can start playing the video sooner.\"'}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:\"https://netflixtechblog.com/modernizing-the-web-playback-ui-1ad2f184a5a0\",children:\"https://netflixtechblog.com/modernizing-the-web-playback-ui-1ad2f184a5a0\"})}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.h3,{id:\"performance\",children:\"Performance\"}),`\n`,(0,i.jsx)(e.p,{children:\"TODO\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"Buffer ahead of current timestamp.\"}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsxs)(e.p,{children:[\"For autoplay videos, YouTube found that using a solid black poster image for autoplay videos was a better experience because the transition from solid black to the first frame of the video to be less-jarring. (\",(0,i.jsx)(e.a,{href:\"https://web.dev/case-studies/better-youtube-web-part1\",children:\"source\"}),\").\"]}),`\n`]}),`\n`,(0,i.jsxs)(e.li,{children:[`\n`,(0,i.jsx)(e.p,{children:\"General\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:\"Lazy load non-visible code like dropdowns, modals.\"}),`\n`,(0,i.jsx)(e.li,{children:\"Responsive thumbnail images.\"}),`\n`]}),`\n`]}),`\n`]}),`\n`,(0,i.jsx)(e.h4,{id:\"preload-poster-image\",children:\"Preload poster image\"}),`\n`,(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:`<link as=\"image\" rel=\"preload\" href=\"poster.jpg\" fetchpriority=\"high\">\n`})}),`\n`,(0,i.jsx)(e.h3,{id:\"user-experience\",children:\"User experience\"}),`\n`,(0,i.jsx)(e.p,{children:\"TODO\"}),`\n`,(0,i.jsx)(e.h3,{id:\"accessibility-a11y\",children:\"Accessibility (a11y)\"}),`\n`,(0,i.jsx)(e.p,{children:\"TODO\"}),`\n`,(0,i.jsx)(e.h3,{id:\"internationalization-i18n\",children:\"Internationalization (i18n)\"}),`\n`,(0,i.jsx)(e.h2,{id:\"todo\",children:\"TODO\"}),`\n`,(0,i.jsx)(e.h2,{id:\"references\",children:\"References\"}),`\n`,(0,i.jsxs)(e.ul,{children:[`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://web.dev/better-youtube-web-part1/\",children:\"Building a Better Web - Part 1: A faster YouTube on web\"})}),`\n`,(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:\"https://web.dev/youtube-media-capabilities/\",children:\"How YouTube improved video performance with the Media Capabilities API\"})}),`\n`]})]})}function k(n={}){let{wrapper:e}=n.components||{};return e?(0,i.jsx)(e,Object.assign({},n,{children:(0,i.jsx)(c,n)})):c(n)}var x=k;return y(A);})();\n;return Component;"
}